<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-bounce.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"chopstickqy.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.22.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="Charles&#39;s blog">
<meta property="og:url" content="https://chopstickqy.github.io/index.html">
<meta property="og:site_name" content="Charles&#39;s blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Charles">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://chopstickqy.github.io/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Charles's blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Charles's blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Charles</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">9</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">28</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    

    
    
      <div class="sidebar-inner sidebar-blogroll">
        <div class="links-of-blogroll animated motion-element links-of-blogroll-block">
          <div class="links-of-blogroll-title">
            <i class="fa fa-history fa-history" aria-hidden="true"></i>
            近期文章
          </div>
          <ul class="links-of-blogroll-list">
            
            
              <li class="recent_posts_li">
                <a href="/post/2025-04-29.html" title="消除异步函数的传染性：构建优雅的同步式异步编程范式" target="_blank">
                  消除异步函数的传染性：构建优雅的同步式异步编程范式
                </a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/post/2025-01-01.html" title="Mac 软件推荐" target="_blank">
                  Mac 软件推荐
                </a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/post/2024-12-13.html" title="Sentry Micro-FE solution" target="_blank">
                  Sentry Micro-FE solution
                </a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/post/2024-11-26.html" title="解决 node-canvas 安装问题：Mac M1、Python 版本、musl 兼容性" target="_blank">
                  解决 node-canvas 安装问题：Mac M1、Python 版本、musl 兼容性
                </a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/post/2021-07-26.html" title="深入了解 qiankun 微前端架构" target="_blank">
                  深入了解 qiankun 微前端架构
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://chopstickqy.github.io/post/collection.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Charles">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Charles's blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Charles's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/collection.html" class="post-title-link" itemprop="url">ISSUE & FEATURE COLLECTION</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：1994-07-15 00:00:00" itemprop="dateCreated datePublished" datetime="1994-07-15T00:00:00+08:00">1994-07-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-05-07 20:24:14" itemprop="dateModified" datetime="2025-05-07T20:24:14+08:00">2025-05-07</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="1-issue-解决访问github-SSL-ERROR-SYSCALL问题"><a href="#1-issue-解决访问github-SSL-ERROR-SYSCALL问题" class="headerlink" title="1 - issue: 解决访问github SSL_ERROR_SYSCALL问题"></a>1 - issue: 解决访问github SSL_ERROR_SYSCALL问题</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git push</span><br><span class="line">fatal: unable to access &#x27;https://github.com/gentleen/token-back-end.git/&#x27;: OpenSSL SSL_connect: SSL_ERROR_SYSCALL in connection to github.com:443</span><br></pre></td></tr></table></figure>

<p>push 代码的时候产生如上错误</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.sslBackend &quot;openssl&quot;</span><br></pre></td></tr></table></figure>

<p>执行如上命令 解决</p>
<h3 id="2-issue-解决AngualrJS不能设置Content-Type请求头问题"><a href="#2-issue-解决AngualrJS不能设置Content-Type请求头问题" class="headerlink" title="2 - issue: 解决AngualrJS不能设置Content-Type请求头问题"></a>2 - issue: 解决AngualrJS不能设置Content-Type请求头问题</h3><p>如 <code>transformRequest</code> 示例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$http(&#123;</span><br><span class="line">    method: &#x27;GET&#x27;,</span><br><span class="line">    url: &#x27;rest/home/banners&#x27;,</span><br><span class="line">    headers: &#123;</span><br><span class="line">        &quot;x-version&quot;: &quot;h5-v1.0.0&quot;,</span><br><span class="line">        &quot;x-timestamp&quot;: currentdate,</span><br><span class="line">        &#x27;Content-type&#x27;: &#x27;application/json&#x27;  </span><br><span class="line">    &#125;,</span><br><span class="line">    transformRequest:function(obj)&#123;</span><br><span class="line">        var str=[];</span><br><span class="line">        for(var p in obj)&#123;</span><br><span class="line">            str.push(encodeURIComponent(p) + &quot;-&quot;+encodeURIComponent(obj[p]));</span><br><span class="line">        &#125;</span><br><span class="line">        return str.join(&quot;&amp;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    ... ...</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="3-feature-Angular-button-throttle-directive-sample"><a href="#3-feature-Angular-button-throttle-directive-sample" class="headerlink" title="3 - feature: Angular button throttle directive sample"></a>3 - feature: Angular button throttle directive sample</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import &#123; Directive, EventEmitter, HostListener, OnInit, Output &#125; from &#x27;@angular/core&#x27;;</span><br><span class="line">import &#123; Subject, Subscription &#125; from &#x27;rxjs&#x27;;</span><br><span class="line">import &#123; throttleTime &#125; from &#x27;rxjs/operators&#x27;;</span><br><span class="line"></span><br><span class="line">@Directive(&#123;</span><br><span class="line">  selector: &#x27;[throttleClickDirective]&#x27;</span><br><span class="line">&#125;)</span><br><span class="line">export class ThrottleClickDirective implements OnInit &#123;</span><br><span class="line">    @Output() throttleClick = new EventEmitter();</span><br><span class="line">    private clicks = new Subject();</span><br><span class="line">    private subscription: Subscription;</span><br><span class="line"></span><br><span class="line">    constructor() &#123; &#125;</span><br><span class="line"></span><br><span class="line">    ngOnInit() &#123;</span><br><span class="line">      this.subscription = this.clicks.pipe(</span><br><span class="line">          throttleTime(1000)</span><br><span class="line">      ).subscribe(e =&gt; this.throttleClick.emit(e));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ngOnDestroy() &#123;</span><br><span class="line">      this.subscription.unsubscribe();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @HostListener(&#x27;click&#x27;, [&#x27;$event&#x27;])</span><br><span class="line">    clickEvent(event) &#123;</span><br><span class="line">      event.preventDefault();</span><br><span class="line">      event.stopPropagation();</span><br><span class="line">      this.clicks.next(event);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="4-issue-Running-docker-container-iptables-No-chain-target-match-by-that-name"><a href="#4-issue-Running-docker-container-iptables-No-chain-target-match-by-that-name" class="headerlink" title="4 - issue: Running docker container : iptables: No chain&#x2F;target&#x2F;match by that name"></a>4 - issue: Running docker container : iptables: No chain&#x2F;target&#x2F;match by that name</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -t filter -F</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -t filter -X</span><br></pre></td></tr></table></figure>

<ul>
<li><p>which indeeds clear all chains. One possible solution is to launch the docker daemon after the iptables setup script. Otherwise you will need to explicitly removes chains you’re interested in.</p>
</li>
<li><p>Then restart docker</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://chopstickqy.github.io/post/2025-04-29.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Charles">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Charles's blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Charles's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/2025-04-29.html" class="post-title-link" itemprop="url">消除异步函数的传染性：构建优雅的同步式异步编程范式</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-04-29 00:00:00" itemprop="dateCreated datePublished" datetime="2025-04-29T00:00:00+08:00">2025-04-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Technology/" itemprop="url" rel="index"><span itemprop="name">Technology</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="异步传染性问题剖析"><a href="#异步传染性问题剖析" class="headerlink" title="异步传染性问题剖析"></a>异步传染性问题剖析</h2><p>JavaScript 作为单线程语言，通过 <code>async/await</code> 语法实现了非阻塞式异步编程。然而这种机制存在显著的异步传染性特征：当某个函数变为异步后，所有直接或间接依赖它的函数都必须标记为 <code>async</code> 并使用 <code>await</code>。这种特性会导致以下问题：</p>
<ol>
<li>调用链污染：底层异步函数会污染整个调用链</li>
<li>代码冗余：需要大量重复的 <code>try/catch</code> 块处理错误</li>
<li>逻辑割裂：同步代码与异步代码混合导致控制流不清晰</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 典型异步传染示例</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">A</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">await</span> <span class="title function_">fetchData</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">B</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">await</span> <span class="title function_">A</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">C</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">B</span>();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="comment">// 错误处理</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如何才能消除这种传染性呢？</p>
<h2 id="核心解决方案：执行续体与缓存机制"><a href="#核心解决方案：执行续体与缓存机制" class="headerlink" title="核心解决方案：执行续体与缓存机制"></a>核心解决方案：执行续体与缓存机制</h2><h3 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h3><p>重组运行时间线<br><img src="https://chopstickqy.github.io/images/2025-04-29/1.png" alt="image"></p>
<p>重写<code>fetch</code>函数<br><img src="https://chopstickqy.github.io/images/2025-04-29/2.png" alt="image"></p>
<p>通过以下三个关键步骤打破异步传染链：</p>
<ol>
<li>首次执行拦截：在数据未就绪时抛出 Promise</li>
<li>后台加载：启动异步操作并缓存结果</li>
<li>续体执行：数据就绪后重新触发原始调用链</li>
</ol>
<h3 id="完整实现方案"><a href="#完整实现方案" class="headerlink" title="完整实现方案"></a>完整实现方案</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cache = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">enhancedFetch</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="comment">// 命中缓存直接返回</span></span><br><span class="line">  <span class="keyword">if</span> (cache.<span class="title function_">has</span>(url)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (cache.<span class="title function_">get</span>(url).<span class="property">status</span> === <span class="string">&#x27;fulfilled&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> cache.<span class="title function_">get</span>(url).<span class="property">data</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> cache.<span class="title function_">get</span>(url).<span class="property">promise</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 初始化缓存记录</span></span><br><span class="line">  <span class="keyword">const</span> record = &#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="string">&#x27;pending&#x27;</span>,</span><br><span class="line">    <span class="attr">promise</span>: <span class="title function_">fetch</span>(url)</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function"><span class="params">r</span> =&gt;</span> r.<span class="title function_">json</span>())</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">        record.<span class="property">status</span> = <span class="string">&#x27;fulfilled&#x27;</span>;</span><br><span class="line">        record.<span class="property">data</span> = data;</span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        record.<span class="property">status</span> = <span class="string">&#x27;rejected&#x27;</span>;</span><br><span class="line">        record.<span class="property">error</span> = error;</span><br><span class="line">      &#125;),</span><br><span class="line">    <span class="attr">data</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">error</span>: <span class="literal">null</span></span><br><span class="line">  &#125;;</span><br><span class="line">  cache.<span class="title function_">set</span>(url, record);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">throw</span> record.<span class="property">promise</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行包装器</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">execute</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> rerun = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      rerun = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">fn</span>();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">if</span> (error <span class="keyword">instanceof</span> <span class="title class_">Promise</span>) &#123;</span><br><span class="line">        error.<span class="title function_">finally</span>(<span class="function">() =&gt;</span> rerun = <span class="literal">true</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> error;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">while</span> (rerun);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fetchUser</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">enhancedFetch</span>(<span class="string">&#x27;/api/user&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">processUser</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> user = <span class="title function_">fetchUser</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;User data:&#x27;</span>, user);</span><br><span class="line">  <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动执行</span></span><br><span class="line"><span class="title function_">execute</span>(processUser);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="React-生态中的生产级解决方案"><a href="#React-生态中的生产级解决方案" class="headerlink" title="React 生态中的生产级解决方案"></a>React 生态中的生产级解决方案</h2><h3 id="Suspense-集成方案"><a href="#Suspense-集成方案" class="headerlink" title="Suspense 集成方案"></a>Suspense 集成方案</h3><p>React 18+ 官方支持的 Suspense 特性正是基于相似的原理实现：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建资源缓存</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createResource</span>(<span class="params">promise</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> status = <span class="string">&#x27;pending&#x27;</span>;</span><br><span class="line">  <span class="keyword">let</span> result;</span><br><span class="line"></span><br><span class="line">  promise.<span class="title function_">then</span>(</span><br><span class="line">    <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">      status = <span class="string">&#x27;success&#x27;</span>;</span><br><span class="line">      result = value;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">      status = <span class="string">&#x27;error&#x27;</span>;</span><br><span class="line">      result = error;</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="title function_">read</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (status === <span class="string">&#x27;pending&#x27;</span>) <span class="keyword">throw</span> promise;</span><br><span class="line">      <span class="keyword">if</span> (status === <span class="string">&#x27;error&#x27;</span>) <span class="keyword">throw</span> result;</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用示例</span></span><br><span class="line"><span class="keyword">const</span> userResource = <span class="title function_">createResource</span>(<span class="title function_">fetch</span>(<span class="string">&#x27;/api/user&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">UserProfile</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> user = userResource.<span class="title function_">read</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;user.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Suspense</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&lt;<span class="attr">Loading</span> /&gt;</span>&#125;&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">UserProfile</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="React-Query-集成"><a href="#React-Query-集成" class="headerlink" title="React Query 集成"></a>React Query 集成</h3><p>现代数据请求库已内置 Suspense 支持：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useQuery &#125; <span class="keyword">from</span> <span class="string">&#x27;@tanstack/react-query&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">UserList</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 同步式数据访问</span></span><br><span class="line">  <span class="keyword">const</span> &#123; data &#125; = <span class="title function_">useQuery</span>(&#123;</span><br><span class="line">    <span class="attr">queryKey</span>: [<span class="string">&#x27;users&#x27;</span>],</span><br><span class="line">    <span class="attr">queryFn</span>: fetchUsers,</span><br><span class="line">    <span class="attr">suspense</span>: <span class="literal">true</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> data.<span class="title function_">map</span>(<span class="function"><span class="params">user</span> =&gt;</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&#123;user.id&#125;</span>&gt;</span>&#123;user.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  ));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>React 官方文档中展示了如何使用 Suspense 和类似 wrapPromise 的机制来处理数据加载<br><a target="_blank" rel="noopener" href="https://17.reactjs.org/docs/concurrent-mode-suspense.html#what-suspense-is-not">React Suspense 官方文档</a></p>
<h2 id="扩展思考"><a href="#扩展思考" class="headerlink" title="扩展思考"></a>扩展思考</h2><p>这种「同步式异步编程」范式在以下场景有显著优势：</p>
<ul>
<li>复杂数据依赖关系处理</li>
<li>服务端渲染（SSR）场景</li>
<li>需要原子化状态管理的场景</li>
</ul>
<p>但需要注意其适用边界，对于简单的一次性请求，传统的 <code>async/await</code> 仍然是更合适的选择。技术选型时应根据具体场景权衡开发体验与实现复杂度。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://chopstickqy.github.io/post/2025-01-01.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Charles">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Charles's blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Charles's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/2025-01-01.html" class="post-title-link" itemprop="url">Mac 软件推荐</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-01-02 00:00:00" itemprop="dateCreated datePublished" datetime="2025-01-02T00:00:00+08:00">2025-01-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%88%E7%8E%87%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">效率工具</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="1-oh-my-zsh-终端的美学与效率革命"><a href="#1-oh-my-zsh-终端的美学与效率革命" class="headerlink" title="1. oh my zsh - 终端的美学与效率革命"></a>1. oh my zsh - 终端的美学与效率革命</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一键安装命令</span></span><br><span class="line">sh -c <span class="string">&quot;<span class="subst">$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)</span>&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>✨ 主题画廊：200+ 主题瞬间美化终端界面</li>
<li>⚡ 智能补全：输入命令时按 Tab 自动提示</li>
<li>🔌 插件生态：<ul>
<li>git：显示分支状态和文件修改标识</li>
<li>zsh-autosuggestions：基于历史记录预测命令</li>
<li>syntax-highlighting：命令行语法高亮</li>
</ul>
</li>
</ul>
<h3 id="2-tmux-终端多任务管理"><a href="#2-tmux-终端多任务管理" class="headerlink" title="2. tmux - 终端多任务管理"></a>2. tmux - 终端多任务管理</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install tmux  <span class="comment"># 通过 Homebrew 安装</span></span><br></pre></td></tr></table></figure>

<ul>
<li>🖥️ 分屏工作流：<code>Ctrl+b %</code> 垂直分屏 &#x2F; <code>Ctrl+b &quot;</code> 水平分屏</li>
<li>💾 会话持久化：SSH 断开后保持进程运行（用 <code>tmux attach</code> 恢复）</li>
<li>🎮 快捷键体系：<ul>
<li><code>Ctrl+b d</code> 分离会话</li>
<li><code>Ctrl+b [</code> 进入滚动模式</li>
<li><code>Ctrl+b z</code> 放大当前面板</li>
</ul>
</li>
</ul>
<p>更多快捷键参考<a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2019/10/tmux.html">tmux 快捷键合集</a></p>
<h3 id="3-hammerspoon-系统自动化神器"><a href="#3-hammerspoon-系统自动化神器" class="headerlink" title="3. hammerspoon - 系统自动化神器"></a>3. hammerspoon - 系统自动化神器</h3><p>Hammerspoon 是一款基于 Lua 脚本的 macOS 自动化工具，功能强大且高度可定制，最主要的，完完完完完全开源免费，相比于<code>Alfred</code>仅此一点就可以无脑冲了。<br>这里给出我在安装使用时参考的<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1VR4y1N7TS/?spm_id_from=333.337.search-card.all.click&vd_source=3c1414cdbe43f98b6bec59170f1bca9a">B站博主视频</a><br>视频内，博主也给出了他自己写的一个<code>lua</code>脚本，没有<code>lua</code>coding基础的小伙伴可以先拿来直接用</p>
<h3 id="4-Obsidian：构建你的第二大脑"><a href="#4-Obsidian：构建你的第二大脑" class="headerlink" title="4. Obsidian：构建你的第二大脑"></a>4. Obsidian：构建你的第二大脑</h3><p>在信息爆炸的时代，如何高效地管理知识成为了每个人的挑战。<a target="_blank" rel="noopener" href="https://obsidian.md/">Obsidian</a>，这款以“第二大脑”为理念的笔记工具，正逐渐成为知识工作者的得力助手。</p>
<h3 id="技术优势"><a href="#技术优势" class="headerlink" title="技术优势"></a>技术优势</h3><ol>
<li><p><strong>代码友好型知识图谱</strong>  </p>
<ul>
<li>支持 <code>[[双向链接]]</code> + <code>#标签</code> + <code>Mermaid图表</code> 三维关联系统</li>
<li>可视化呈现技术概念间的调用关系（如微服务架构拓扑）</li>
<li>通过 <code>Dataview</code> 插件实现类数据库查询：  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LIST WHERE contains(tags, &quot;#API设计&quot;) AND file.ctime &gt; date(2023-01-01)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>工程化扩展能力</strong></p>
<ul>
<li>插件系统基于 TypeScript 开发，支持自定义工作流：<ul>
<li>集成 Terminal 实现 CLI 操作</li>
<li>通过 REST API 连接 Jira&#x2F;Jenkins</li>
<li>开发代码片段自动收集插件</li>
</ul>
</li>
<li>CSS 主题定制 + 热重载调试，媲美 IDE 的个性化体验</li>
</ul>
</li>
<li><p><strong>Git 原生工作流</strong></p>
<ul>
<li>纯 Markdown 存储天然适配版本控制</li>
<li>自动 commit 插件实现文档 CI&#x2F;CD：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .obsidian/git-auto-commit.sh</span></span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;Auto-save: <span class="subst">$(date)</span>&quot;</span></span><br><span class="line">git push origin main</span><br></pre></td></tr></table></figure></li>
<li>完美支持 GitHub Pages 文档同步发布</li>
</ul>
</li>
</ol>
<h3 id="开发者应用场景"><a href="#开发者应用场景" class="headerlink" title="开发者应用场景"></a>开发者应用场景</h3><p>▌ 技术文档中枢</p>
<ul>
<li>用 <code>Admonition</code> 插件创建标准化的 API 说明模板</li>
<li>通过 <code>Excalidraw</code> 绘制系统架构图并嵌入文档</li>
<li>使用 <code>CodeMirror</code> 实现 IDE 级代码高亮</li>
</ul>
<p>▌ 学习攻坚利器  </p>
<ul>
<li>建立 <code>算法题解/设计模式/源码分析</code> 的网状知识库</li>
<li>用 <code>Latex Suite</code> 高效编写技术公式：<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line">O(n<span class="keyword">\log</span> n) <span class="built_in">&amp;</span> <span class="keyword">\text</span>&#123; 时间复杂度 &#125; <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>▌ 研发过程管理</p>
<ul>
<li>Kanban 看板跟踪 Sprint 任务</li>
<li>Templater 自动生成 RFC 技术提案模板</li>
<li>通过 Daily Notes 实现 standup meeting 记录</li>
</ul>
<p>▌ 个人代码库</p>
<ul>
<li>构建可搜索的代码片段库：<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 快速排序 @Algorithms</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">quick_sort</span>(<span class="params">arr</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(arr) &lt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> arr</span><br><span class="line">    pivot = arr[<span class="built_in">len</span>(arr) // <span class="number">2</span>]</span><br><span class="line">    left = [x <span class="keyword">for</span> x <span class="keyword">in</span> arr <span class="keyword">if</span> x &lt; pivot]</span><br><span class="line">    middle = [x <span class="keyword">for</span> x <span class="keyword">in</span> arr <span class="keyword">if</span> x == pivot]</span><br><span class="line">    right = [x <span class="keyword">for</span> x <span class="keyword">in</span> arr <span class="keyword">if</span> x &gt; pivot]</span><br><span class="line">    <span class="keyword">return</span> quick_sort(left) + middle + quick_sort(right)</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="进阶技巧"><a href="#进阶技巧" class="headerlink" title="进阶技巧"></a>进阶技巧</h3><ul>
<li>使用 VSCode-Obsidian 插件实现双编辑器联动</li>
<li>通过 Obsidian Git 实现多设备同步</li>
<li>开发自定义插件对接内部 DevOps 平台</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://chopstickqy.github.io/post/2024-12-13.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Charles">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Charles's blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Charles's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/2024-12-13.html" class="post-title-link" itemprop="url">Sentry Micro-FE solution</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-12-13 00:00:00" itemprop="dateCreated datePublished" datetime="2024-12-13T00:00:00+08:00">2024-12-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Technology/" itemprop="url" rel="index"><span itemprop="name">Technology</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="前景介绍"><a href="#前景介绍" class="headerlink" title="前景介绍"></a>前景介绍</h2><p>项目在迭代过程中，公共逻辑或组件的重复使用频率也在逐渐增加。为了方便管理公共组件代码，提升开发效率等，在项目中引入微前端或者微组件的概念。</p>
<p>当前项目的 source map 通过 Jenkins 部署代码时同步上传到 Sentry 进行管理，因此，其他 gems 或 sweets 组件无法通过相同方式上传 source map。因此，需要新的方案来解决微前端项目的 source map 上传问题。</p>
<h2 id="方案"><a href="#方案" class="headerlink" title="方案"></a>方案</h2><p>Sentry 官网提供了微前端方案：<a target="_blank" rel="noopener" href="https://docs.sentry.io/platforms/javascript/guides/deno/best-practices/micro-frontends/">Sentry Micro-Frontends</a>。</p>
<h3 id="功能代码修改："><a href="#功能代码修改：" class="headerlink" title="功能代码修改："></a>功能代码修改：</h3><ul>
<li>引入 <strong>Sentry Plugin - moduleMetadata 模块</strong>，对编译后的文件增加元数据。</li>
<li>Sentry 初始化时引入 <strong>metadataIntegrations</strong> 处理元数据。</li>
<li>通过元数据 <strong>多路传输</strong>。</li>
</ul>
<h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><h3 id="Sentry-Plugin-Metadata-Module"><a href="#Sentry-Plugin-Metadata-Module" class="headerlink" title="Sentry Plugin - Metadata Module"></a><a target="_blank" rel="noopener" href="https://github.com/search?q=repo:getsentry/sentry-javascript-bundler-plugins%20webpackModuleMetadataInjectionPlugin&type=code">Sentry Plugin - Metadata Module</a></h3><ul>
<li>该插件通过 Webpack 内置的 <code>BannerPlugin</code> 在编译后的文件头部注入元数据。</li>
<li>元数据会注入到 <code>window.sentryModuleMetadata</code> 对象下，<code>[key]</code> 为当前文件的 URL (<code>new window.Error().stack</code>)，<code>[value]</code> 为元数据值。</li>
</ul>
<h3 id="moduleMetadataIntegration"><a href="#moduleMetadataIntegration" class="headerlink" title="moduleMetadataIntegration"></a><a target="_blank" rel="noopener" href="https://github.com/getsentry/sentry-javascript/blob/13bb652e068693eaad920467133f19cde46b0a85/packages/core/src/integrations/metadata.ts#L16">moduleMetadataIntegration</a></h3><ul>
<li>通过 <code>beforeEnvelope</code> 生命周期拦截发送到 Sentry 的数据包，从事件的堆栈帧（stack frames）中剥离元数据（metadata），确保数据仅在客户端处理，不会发送到 Sentry 服务器，减少传输的数据量并保护隐私。</li>
<li>通过 <code>applyFrameMetadata</code> 生命周期，将元数据注入到当前事件中。</li>
</ul>
<h3 id="多路传输-makeMultiplexedTransport"><a href="#多路传输-makeMultiplexedTransport" class="headerlink" title="多路传输 makeMultiplexedTransport"></a>多路传输 <code>makeMultiplexedTransport</code></h3><ul>
<li><code>beforeSend</code> 增加解析元数据逻辑，并注入到事件中。</li>
<li>注册多路传输 <code>transport</code>，根据解析出的元数据分发请求。</li>
</ul>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ul>
<li>元数据中必须的参数 <code>dsn</code> 和 <code>release</code><ul>
<li><code>dsn</code>：用于请求发送到指定仓库。</li>
<li><code>release</code>：用于版本匹配映射到具体的 source map。<ul>
<li>使用 <code>DefinePlugin</code> 将打包的镜像版本设置为全局变量：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> webpack.<span class="title class_">DefinePlugin</span>(&#123;</span><br><span class="line">  <span class="string">&#x27;process.env.RELEASE_TAG&#x27;</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(release)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://chopstickqy.github.io/post/2024-11-26.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Charles">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Charles's blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Charles's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/2024-11-26.html" class="post-title-link" itemprop="url">解决 node-canvas 安装问题：Mac M1、Python 版本、musl 兼容性</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-11-26 00:00:00" itemprop="dateCreated datePublished" datetime="2024-11-26T00:00:00+08:00">2024-11-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">技术</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>在项目中需要生成二维码，因此选择了 <code>easyqrcodejs</code> 作为前端和后端（Node.js）二维码生成方案。然而，在服务端使用 <code>easyqrcodejs</code> 时，依赖的 <code>node-canvas</code> 安装过程中遇到了一些问题。本文记录并提供相应的解决方案。</p>
<hr>
<h2 id="遇到的问题及解决方案"><a href="#遇到的问题及解决方案" class="headerlink" title="遇到的问题及解决方案"></a>遇到的问题及解决方案</h2><h3 id="1-Mac-M1-芯片无法安装-node-canvas"><a href="#1-Mac-M1-芯片无法安装-node-canvas" class="headerlink" title="1. Mac M1 芯片无法安装 node-canvas"></a>1. Mac M1 芯片无法安装 <code>node-canvas</code></h3><p>Mac M1 电脑缺少 <code>node-canvas</code> 运行所需的依赖库。可以通过以下命令安装必要的依赖：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install pkg-config cairo pango libpng jpeg giflib librsvg</span><br></pre></td></tr></table></figure>

<blockquote>
<p>相关 Issue：<a target="_blank" rel="noopener" href="https://github.com/Automattic/node-canvas/issues/1733">Can’t install on Apple M1</a></p>
</blockquote>
<hr>
<h3 id="2-Python-版本过高导致-import-gyp-报错"><a href="#2-Python-版本过高导致-import-gyp-报错" class="headerlink" title="2. Python 版本过高导致 import gyp 报错"></a>2. Python 版本过高导致 <code>import gyp</code> 报错</h3><h4 id="报错信息片段："><a href="#报错信息片段：" class="headerlink" title="报错信息片段："></a>报错信息片段：</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Traceback (most recent call last):</span><br><span class="line">File <span class="string">&quot;/Users/w/.nvm/versions/node/v18.20.4/lib/node_modules/pnpm/dist/node_modules/node-gyp/gyp/gyp_main.py&quot;</span>, line 42, <span class="keyword">in</span> ‹module:</span><br><span class="line">import gyp</span><br></pre></td></tr></table></figure>

<h4 id="解决方案："><a href="#解决方案：" class="headerlink" title="解决方案："></a>解决方案：</h4><p>该问题通常由 Python 版本过高导致，可使用 Python 3.9.6 解决：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pyenv install 3.9.6</span><br><span class="line">pyenv global 3.9.6</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="3-node-canvas-安装时报错：Not-Found-on-XXXX"><a href="#3-node-canvas-安装时报错：Not-Found-on-XXXX" class="headerlink" title="3. node-canvas 安装时报错：Not Found on XXXX"></a>3. <code>node-canvas</code> 安装时报错：<code>Not Found on XXXX</code></h3><h4 id="报错信息："><a href="#报错信息：" class="headerlink" title="报错信息："></a>报错信息：</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node-pre-gyp ERR! install response status 404 Not Found on https://github.com/Automattic/node-canvas/releases/download/v2.11.2/canvas-v2.11.2-node-v108-linux-musl-x64.tar.gz</span><br></pre></td></tr></table></figure>

<h4 id="问题分析："><a href="#问题分析：" class="headerlink" title="问题分析："></a>问题分析：</h4><p>错误发生在 Linux 服务器上，其中 <code>musl</code> 代表 Linux 操作系统使用的 C 标准库，而 <code>node-canvas</code> 仅支持 <code>glibc</code>，不兼容 <code>musl</code> 版本的系统。因此，如果使用 Docker 镜像进行构建，需要确保镜像基于 <code>glibc</code>。</p>
<h4 id="解决方案：-1"><a href="#解决方案：-1" class="headerlink" title="解决方案："></a>解决方案：</h4><p>如果在 Alpine Linux（默认使用 <code>musl</code>）上安装 <code>node-canvas</code>，可以切换到 <code>glibc</code> 版本的 Linux 发行版，或者使用 <code>glibc</code> 兼容的 <code>node-canvas</code> 版本。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用带 glibc 的 Node.js 镜像</span></span><br><span class="line">docker pull node:lts-bullseye</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="4-替换国内镜像源以加速安装"><a href="#4-替换国内镜像源以加速安装" class="headerlink" title="4. 替换国内镜像源以加速安装"></a>4. 替换国内镜像源以加速安装</h3><p>由于 <code>node-canvas</code> 需要从 <code>github</code> 下载二进制文件，国内访问较慢或受限，可使用淘宝 <code>npm</code> 镜像源进行加速。</p>
<h4 id="配置-npmrc-文件："><a href="#配置-npmrc-文件：" class="headerlink" title="配置 .npmrc 文件："></a>配置 <code>.npmrc</code> 文件：</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">canvas_binary_host_mirror=https://registry.npmmirror.com/-/binary/canvas/</span><br></pre></td></tr></table></figure>

<h4 id="直接使用-npm-安装："><a href="#直接使用-npm-安装：" class="headerlink" title="直接使用 npm 安装："></a>直接使用 <code>npm</code> 安装：</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --canvas_binary_host_mirror=https://registry.npmmirror.com/-/binary/canvas/</span><br></pre></td></tr></table></figure>

<h4 id="使用-pnpm-安装："><a href="#使用-pnpm-安装：" class="headerlink" title="使用 pnpm 安装："></a>使用 <code>pnpm</code> 安装：</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm install --config.canvas_binary_host_mirror=https://registry.npmmirror.com/-/binary/canvas/</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>在使用 <code>node-canvas</code> 进行二维码生成时，可能会遇到多个环境相关的问题。本文提供了解决 Mac M1、Python 版本、<code>musl</code> 兼容性以及安装加速等方法，希望能帮助遇到相同问题的开发者。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://chopstickqy.github.io/post/2021-07-26.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Charles">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Charles's blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Charles's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/2021-07-26.html" class="post-title-link" itemprop="url">深入了解 qiankun 微前端架构</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-07-26 00:00:00" itemprop="dateCreated datePublished" datetime="2021-07-26T00:00:00+08:00">2021-07-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">技术</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>随着前端应用的复杂度不断提升，传统的单体应用架构逐渐暴露出维护困难、技术栈升级困难等问题。为了解决这些挑战，微前端架构应运而生。qiankun 作为一款基于 single-spa 的微前端实现库，提供了高效、灵活的解决方案，帮助开发者构建可维护、可扩展的前端系统。</p>
<h2 id="什么是微前端？"><a href="#什么是微前端？" class="headerlink" title="什么是微前端？"></a>什么是微前端？</h2><p>微前端是一种将大型前端应用拆分成多个小型、独立、自治的子应用的架构模式。每个子应用可以使用不同的技术栈，独立开发、独立部署，最终通过主应用进行统一管理和展示。微前端的核心思想是“拆”和“合”，即将复杂的应用拆解成多个小模块，再通过主应用将其组合成一个完整的系统。</p>
<h2 id="Qiankun-的优势"><a href="#Qiankun-的优势" class="headerlink" title="Qiankun 的优势"></a>Qiankun 的优势</h2><p>Qiankun 作为微前端的实现库，具有以下优势：</p>
<ul>
<li><strong>技术栈无关</strong>：主应用和子应用可以使用不同的技术栈，互不干扰。</li>
<li><strong>独立开发与部署</strong>：每个子应用可以独立开发、独立部署，提升开发效率。</li>
<li><strong>增量升级</strong>：可以逐步将老旧系统迁移到微前端架构，实现平滑过渡。</li>
<li><strong>运行时隔离</strong>：子应用之间相互隔离，避免相互影响。</li>
</ul>
<h2 id="Qiankun-的工作原理"><a href="#Qiankun-的工作原理" class="headerlink" title="Qiankun 的工作原理"></a>Qiankun 的工作原理</h2><p>Qiankun 通过以下方式实现微前端架构：</p>
<ol>
<li><strong>主应用注册子应用</strong>：主应用通过 Qiankun 提供的 API 注册各个子应用，指定子应用的加载方式、路由规则等。</li>
<li><strong>子应用加载</strong>：当路由匹配到某个子应用时，Qiankun 会加载对应的子应用，并将其挂载到指定的 DOM 节点上。</li>
<li><strong>生命周期管理</strong>：Qiankun 为每个子应用提供了生命周期钩子函数，如 <code>bootstrap</code>、<code>mount</code>、<code>unmount</code>，开发者可以在这些钩子中编写相应的逻辑。</li>
</ol>
<h2 id="实践案例"><a href="#实践案例" class="headerlink" title="实践案例"></a>实践案例</h2><p>为了更好地理解 qiankun 的使用，以下是一个简单的示例，展示了如何使用 qiankun 实现微前端架构。</p>
<h3 id="架构示意图"><a href="#架构示意图" class="headerlink" title="架构示意图"></a>架构示意图</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+</span><br><span class="line">|   主应用 (Angular)   |</span><br><span class="line">|                   |</span><br><span class="line">|  +-------------+  |</span><br><span class="line">|  | 子应用 1    |  |</span><br><span class="line">|  | (Angular)  |  |</span><br><span class="line">|  +-------------+  |</span><br><span class="line">|  +-------------+  |</span><br><span class="line">|  | 子应用 2    |  |</span><br><span class="line">|  | (Vue)      |  |</span><br><span class="line">|  +-------------+  |</span><br><span class="line">|  +-------------+  |</span><br><span class="line">|  | 子应用 3    |  |</span><br><span class="line">|  | (React)    |  |</span><br><span class="line">|  +-------------+  |</span><br><span class="line">+-------------------+</span><br></pre></td></tr></table></figure>


<h2 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h2><h3 id="1-创建主应用-Angular"><a href="#1-创建主应用-Angular" class="headerlink" title="1. 创建主应用 (Angular)"></a>1. 创建主应用 (Angular)</h3><p>首先，在 Angular 项目中安装 qiankun</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install qiankun</span><br></pre></td></tr></table></figure>

<p>然后，在主应用中设置 qiankun 来加载子应用：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Component</span>, <span class="title class_">OnInit</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@angular/core&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; registerMicroApps, setDefaultMountApp, start &#125; <span class="keyword">from</span> <span class="string">&#x27;qiankun&#x27;</span>;</span><br><span class="line"></span><br><span class="line">@<span class="title class_">Component</span>(&#123;</span><br><span class="line">  <span class="attr">selector</span>: <span class="string">&#x27;#parent-angular app-root&#x27;</span>,</span><br><span class="line">  <span class="attr">templateUrl</span>: <span class="string">&#x27;./app.component.html&#x27;</span>,</span><br><span class="line">  <span class="attr">styleUrls</span>: [<span class="string">&#x27;./app.component.scss&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">AppComponent</span> implements <span class="title class_">OnInit</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">ngOnInit</span>() : <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">registerMicroApps</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">registerMicroApps</span>() : <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="title function_">registerMicroApps</span>([</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;child-react&#x27;</span>,</span><br><span class="line">        <span class="attr">entry</span>: <span class="string">&#x27;//localhost:3000&#x27;</span>,</span><br><span class="line">        <span class="attr">container</span>: <span class="string">&#x27;#subapp-viewer&#x27;</span>,</span><br><span class="line">        <span class="attr">activeRule</span>: <span class="function"><span class="params">location</span> =&gt;</span> location.<span class="property">hash</span>.<span class="title function_">startsWith</span>(<span class="string">&#x27;#/sub-micro/child-react&#x27;</span>)</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;child-vue&#x27;</span>,</span><br><span class="line">        <span class="attr">entry</span>: <span class="string">&#x27;//localhost:8080&#x27;</span>,</span><br><span class="line">        <span class="attr">container</span>: <span class="string">&#x27;#subapp-viewer&#x27;</span>,</span><br><span class="line">        <span class="attr">activeRule</span>: <span class="function"><span class="params">location</span> =&gt;</span> location.<span class="property">hash</span>.<span class="title function_">startsWith</span>(<span class="string">&#x27;#/sub-micro/child-vue&#x27;</span>)</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;child-angular&#x27;</span>,</span><br><span class="line">        <span class="attr">entry</span>: <span class="string">&#x27;//localhost:4300&#x27;</span>,</span><br><span class="line">        <span class="attr">container</span>: <span class="string">&#x27;#subapp-viewer&#x27;</span>,</span><br><span class="line">        <span class="attr">activeRule</span>: <span class="function"><span class="params">location</span> =&gt;</span> location.<span class="property">hash</span>.<span class="title function_">startsWith</span>(<span class="string">&#x27;#/sub-micro/child-angular&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">beforeLoad</span>: [</span><br><span class="line">        <span class="function"><span class="params">app</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[LifeCycle] before load %c%s&#x27;</span>, <span class="string">&#x27;color: green;&#x27;</span>, app.<span class="property">name</span>);</span><br><span class="line">          <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>();</span><br><span class="line">        &#125;,</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">beforeMount</span>: [</span><br><span class="line">        <span class="function"><span class="params">app</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[LifeCycle] before mount %c%s&#x27;</span>, <span class="string">&#x27;color: green;&#x27;</span>, app.<span class="property">name</span>);</span><br><span class="line">          <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>();</span><br><span class="line">        &#125;,</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">afterUnmount</span>: [</span><br><span class="line">        <span class="function"><span class="params">app</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;[LifeCycle] after unmount %c%s&#x27;</span>, <span class="string">&#x27;color: green;&#x27;</span>, app.<span class="property">name</span>);</span><br><span class="line">          <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>();</span><br><span class="line">        &#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在子项目路由根组件中调用<code>start</code>方法加载<code>qiankun</code></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AfterViewInit</span>, <span class="title class_">Component</span>, <span class="title class_">OnInit</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@angular/core&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; registerMicroApps, start &#125; <span class="keyword">from</span> <span class="string">&#x27;qiankun&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  <span class="attr">selector</span>: <span class="string">&#x27;app-sub-micro&#x27;</span>,</span><br><span class="line">  <span class="attr">templateUrl</span>: <span class="string">&#x27;./sub-micro.component.html&#x27;</span>,</span><br><span class="line">  <span class="attr">styleUrls</span>: [<span class="string">&#x27;./sub-micro.component.scss&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">SubMicroComponent</span> <span class="keyword">implements</span> <span class="title class_">OnInit</span>, <span class="title class_">AfterViewInit</span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123; &#125;</span><br><span class="line">  <span class="title function_">ngAfterViewInit</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="title function_">start</span>(</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">prefetch</span>: <span class="literal">false</span> <span class="comment">// 取消预加载</span></span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">ngOnInit</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-创建子应用-Angular"><a href="#2-创建子应用-Angular" class="headerlink" title="2. 创建子应用 (Angular)"></a>2. 创建子应用 (Angular)</h3><p>使用 Angular 创建一个子应用，并确保它能够独立运行。确保在构建时，将子应用暴露为一个微前端应用，供主应用加载。<br>通过<code>window.__POWERED_BY_QIANKUN__</code>标识判断当前应用是否是通过 qiankun 加载的微前端子应用。如果该值为 true，说明当前应用是一个微前端子应用；如果为 false，说明应用是独立运行的</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="variable constant_">APP_BASE_HREF</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@angular/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">NgModule</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@angular/core&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">RouterModule</span>, <span class="title class_">Routes</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@angular/router&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">routes</span>: <span class="title class_">Routes</span> = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">loadChildren</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;./home/home.module&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">m</span> =&gt;</span> m.<span class="property">HomeModule</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;readme&#x27;</span>,</span><br><span class="line">    <span class="attr">loadChildren</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;./readme/readme.module&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">m</span> =&gt;</span> m.<span class="property">ReadmeModule</span>)</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="meta">@NgModule</span>(&#123;</span><br><span class="line">  <span class="attr">imports</span>: [<span class="title class_">RouterModule</span>.<span class="title function_">forRoot</span>(routes)],</span><br><span class="line">  <span class="attr">exports</span>: [<span class="title class_">RouterModule</span>],</span><br><span class="line">  <span class="comment">// @ts-ignore</span></span><br><span class="line">  <span class="attr">providers</span>: [&#123;<span class="attr">provide</span>: <span class="variable constant_">APP_BASE_HREF</span>, <span class="attr">useValue</span>: <span class="variable language_">window</span>.<span class="property">__POWERED_BY_QIANKUN__</span> ? <span class="string">&#x27;/sub-micro/child-angular&#x27;</span> : <span class="string">&#x27;/&#x27;</span>&#125;]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">AppRoutingModule</span> &#123; &#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-创建子应用-Vue"><a href="#3-创建子应用-Vue" class="headerlink" title="3. 创建子应用 (Vue)"></a>3. 创建子应用 (Vue)</h3><p>使用 Vue 创建一个子应用，并确保它能够独立运行。确保在构建时，将子应用暴露为一个微前端应用，供主应用加载。<br>通过<code>window.__POWERED_BY_QIANKUN__</code>标识判断当前应用是否是通过 qiankun 加载的微前端子应用。如果该值为 true，说明当前应用是一个微前端子应用；如果为 false，说明应用是独立运行的</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">VueRouter</span>, &#123; <span class="title class_">RouteConfig</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;../views/Home.vue&#x27;</span>;</span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">const</span> <span class="attr">window</span>: <span class="built_in">any</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">VueRouter</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">routes</span>: <span class="title class_">RouteConfig</span>[] = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/sub-micro/child-vue/&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Home&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Home</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/sub-micro/child-vue/about&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;About&#x27;</span>,</span><br><span class="line">    <span class="comment">// route level code-splitting</span></span><br><span class="line">    <span class="comment">// this generates a separate chunk (about.[hash].js) for this route</span></span><br><span class="line">    <span class="comment">// which is lazy-loaded when the route is visited.</span></span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="comment">/* webpackChunkName: &quot;about&quot; */</span> <span class="string">&#x27;../views/About.vue&#x27;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">VueRouter</span>(&#123;</span><br><span class="line">  <span class="attr">base</span>: <span class="variable language_">window</span>.<span class="property">__POWERED_BY_QIANKUN__</span> ? <span class="string">&#x27;/sub-micro/child-vue&#x27;</span> : <span class="string">&#x27;/sub-micro/child-vue&#x27;</span>,</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;hash&#x27;</span>,</span><br><span class="line">  routes,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure>

<h3 id="4-创建子应用-React"><a href="#4-创建子应用-React" class="headerlink" title="4. 创建子应用 (React)"></a>4. 创建子应用 (React)</h3><p>使用 React 创建一个子应用，并确保它能够独立运行。确保在构建时，将子应用暴露为一个微前端应用，供主应用加载。<br>通过<code>window.__POWERED_BY_QIANKUN__</code>标识判断当前应用是否是通过 qiankun 加载的微前端子应用。如果该值为 true，说明当前应用是一个微前端子应用；如果为 false，说明应用是独立运行的</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./public-path&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BrowserRouter</span>,<span class="title class_">HashRouter</span>,<span class="title class_">Route</span>,<span class="title class_">Switch</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.css&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;./home&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Readme</span> <span class="keyword">from</span> <span class="string">&#x27;./readme/readme&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">render</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; container &#125; = props;</span><br><span class="line">  <span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">HashRouter</span> <span class="attr">basename</span>=<span class="string">&#123;window.__POWERED_BY_QIANKUN__</span> ? &#x27;/<span class="attr">sub-micro</span>/<span class="attr">child-react</span>&#x27; <span class="attr">:</span> &#x27;/&#x27;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Switch</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">exact</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Home&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">exact</span> <span class="attr">path</span>=<span class="string">&quot;/readme&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Readme&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Switch</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">HashRouter</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">React.StrictMode</span>&gt;</span></span>,</span><br><span class="line"> container ? container.<span class="title function_">querySelector</span>(<span class="string">&#x27;#root&#x27;</span>) : <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#root&#x27;</span>)</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable language_">window</span>.<span class="property">__POWERED_BY_QIANKUN__</span>) &#123;</span><br><span class="line">  <span class="title function_">render</span>(&#123;&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">bootstrap</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">mount</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="title function_">render</span>(props);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">unmount</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; container &#125; = props;</span><br><span class="line">  <span class="title class_">ReactDOM</span>.<span class="title function_">unmountComponentAtNode</span>(container ? container.<span class="title function_">querySelector</span>(<span class="string">&#x27;#root&#x27;</span>) : <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#root&#x27;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="运行和部署"><a href="#运行和部署" class="headerlink" title="运行和部署"></a>运行和部署</h2><p>在完成以上步骤后，可以启动各个子应用和主应用，确保它们都能独立运行，并通过 qiankun 框架将它们集成在一起。</p>
<p>子应用的运行地址分别是：</p>
<ul>
<li>Angular 子应用：<a target="_blank" rel="noopener" href="http://localhost:3000/">http://localhost:3000</a></li>
<li>Vue 子应用：<a target="_blank" rel="noopener" href="http://localhost:8000/">http://localhost:8000</a></li>
<li>React 子应用：<a target="_blank" rel="noopener" href="http://localhost:4300/">http://localhost:4300</a></li>
</ul>
<h2 id="Demo-代码"><a href="#Demo-代码" class="headerlink" title="Demo 代码"></a>Demo 代码</h2><p>为了帮助您更好地理解整个过程，我已经将所有代码整合并发布到了 GitHub。您可以访问 <a target="_blank" rel="noopener" href="https://github.com/chopstickqy/qiankun-demo">qiankun-demo</a> 查看完整的代码实现，并根据自己的需求进行修改。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://chopstickqy.github.io/post/2021-07-16.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Charles">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Charles's blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Charles's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/2021-07-16.html" class="post-title-link" itemprop="url">AppHangB1引起的explorer进程停止与Windows交互解决方法</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-07-16 08:00:00" itemprop="dateCreated datePublished" datetime="2021-07-16T08:00:00+08:00">2021-07-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-05-07 20:24:14" itemprop="dateModified" datetime="2025-05-07T20:24:14+08:00">2025-05-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5/" itemprop="url" rel="index"><span itemprop="name">故障排查</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近办公电脑（windows）的资源管理器突然一直未响应，查资料找了几天，终于解决了，这里贴出来解决方案。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/CoderAldrich/article/details/47974357?locationNum=2&fps=1">原文链接</a></li>
</ul>
<h2 id="解决方案（一）"><a href="#解决方案（一）" class="headerlink" title="解决方案（一）"></a>解决方案（一）</h2><p>第一步：首先确认导致问题的原因是不是缺少系统文件，使用系统文件检查工具（SFC.exe）。</p>
<ol>
<li>Win+X,选择管理员运行Windows Powershell，如果弹出一个窗口要求确认，请点击“是”</li>
<li>输入命令SFC &#x2F;SCANNOW 并点击 ENTER，SFC.exe会扫描所有受保护的系统文件并用正确版本的文件代替不正确的文件</li>
<li>重启后观察是否解决</li>
</ol>
<h2 id="解决方案（二）"><a href="#解决方案（二）" class="headerlink" title="解决方案（二）"></a>解决方案（二）</h2><p>第二步：如果SFC扫描不能起作用，就尝试运行纯净启动，找出导致此问题的开机启动应用程序或后台程序以及服务。</p>
<ol>
<li>WIN+R打开运行窗口；</li>
<li>输入msconfig并点击ENTER（若弹窗要求管理员权限，请点击”是“）</li>
<li>在常规选项卡中选中有选择的启动</li>
<li>在有选择的启动下方选中使用原引导配置<br><img src="https://chopstickqy.github.io/images/2025-07-16/1.png" alt="image"></li>
<li>切换到服务选项卡，选中“隐藏所有Microsoft服务”的编辑框，然后点击全部禁止<br><img src="https://chopstickqy.github.io/images/2025-07-16/2.png" alt="image"></li>
<li>点击确定，保存其它文档并重启系统。<br>如果系统重启后问题得到了解决，说明不是系统应用导致的问题，查看上图启动中开机启动的应用程序，很有可能就是他们导致的，更详细的信息参考：<a target="_blank" rel="noopener" href="https://support.microsoft.com/kb/331796">support.microsoft.com&#x2F;kb&#x2F;331796</a></li>
</ol>
<h2 id="解决方案（三）"><a href="#解决方案（三）" class="headerlink" title="解决方案（三）"></a>解决方案（三）</h2><p>第三步：如果以上方法都没有解决你的问题，请看阅读下面内容</p>
<ol>
<li>你的电脑是否是离线（无网络）工作，如果是请继续阅读。</li>
<li>你的window系统是否为win10最新版本，如果是请继续阅读。</li>
<li>恭喜你，这里有解决办法，微软在近期更新时在任务栏增加了资讯和兴趣模块，右键任务栏就可以看到，这个任务栏在无网络的情况下，获取咨询或者日期无效就会倒是任务栏效应失败引起explore进程停止，所以你要做的就是关闭资讯和兴趣，到此，问题解决结束。</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://chopstickqy.github.io/post/2021-06-15.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Charles">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Charles's blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Charles's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/2021-06-15.html" class="post-title-link" itemprop="url">私有化部署CodePush 以及 Ionic + Angular + Cordova 项目集成微软 CodePush</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-06-15 08:00:00" itemprop="dateCreated datePublished" datetime="2021-06-15T08:00:00+08:00">2021-06-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-05-07 20:24:14" itemprop="dateModified" datetime="2025-05-07T20:24:14+08:00">2025-05-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Technology/" itemprop="url" rel="index"><span itemprop="name">Technology</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>APP在发布后如果有一点点小问题需要改动，需要重新审核发布（此处cue到 <strong>APP Store</strong>）时需要花费一到两天的时间，那么当改动的仅仅是静态文件时（HTML&#x2F;CSS&#x2F;JAVASCRIPT），可不可以仅仅从远端服务器拉取文件替换本地文件，来达到热更新呢？答案一定是可以的，废话继续我们先来了解一下<code>CodePush</code>。</p>
<h2 id="CodePush-简介"><a href="#CodePush-简介" class="headerlink" title="CodePush 简介"></a>CodePush 简介</h2><p>来看一下官方介绍</p>
<blockquote>
<p>CodePush is a cloud service that enables Cordova and React Native developers to deploy mobile app updates directly to their users’ devices. It works by acting as a central repository that developers can publish updates to (JS, HTML, CSS and images), and that apps can query for updates from (using provided client SDK for Cordova and React Native). This allows you to have a more deterministic and direct engagement model with your userbase, when addressing bugs and&#x2F;or adding small features that don’t require you to re-build a binary and re-distribute it through the respective app stores.<br>To get started using CodePush, refer to our documentation, otherwise, read the following steps if you’d like to build&#x2F;contribute to the project from source.<br><em>NOTE: If you need information about code-push management CLI, you can find it in v3.0.1.</em></p>
</blockquote>
<p>我们注重这句话：<strong>它使<code>Cordova</code>和<code>React Native</code>开发人员能够将移动应用程序更新直接部署到用户的设备上</strong>。<br>使用<code>CodePush</code>可以使我们在不重新构建和发布程序的前提下，更新一些静态文件（JS,HTML,CSS和图片）。</p>
<p>**<em>注意：本文所写的<code>CodePush</code>技术在2017年后已经被微软整合到 App Center</em><br>所以本文可能已经被时代的大浪遗弃了，各位有更好的解决方案，可以留言我。</p>
<h2 id="私有化部署CodePush服务"><a href="#私有化部署CodePush服务" class="headerlink" title="私有化部署CodePush服务"></a>私有化部署CodePush服务</h2><h3 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h3><p>运行<code>code-push-server</code>需要<code>node</code>环境和<code>mysql</code>数据库（其他数据库也可以，需要改源码）支持，对于<code>node</code>和<code>mysql</code>就不多做解释了，我们先来安装这两个工具：<br>因为我本地有<code>node</code>环境，所以没有重新进行安装，需要安装的小伙伴们可以在<a target="_blank" rel="noopener" href="https://nodejs.org/zh-cn/">官网</a>下载安装。<br>列出我本地的<code>node</code>和<code>npm</code>版本</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node v12<span class="number">.18</span><span class="number">.3</span></span><br><span class="line">npm <span class="number">6.14</span><span class="number">.6</span></span><br></pre></td></tr></table></figure>
<p>mysql数据库使用的版本是：<a target="_blank" rel="noopener" href="https://cdn.mysql.com//Downloads/MySQLInstaller/mysql-installer-community-8.0.25.0.msi">mysql-installer-community-8.0.25.0.msi</a></p>
<h3 id="安装、配置和部署私有化code-push-server"><a href="#安装、配置和部署私有化code-push-server" class="headerlink" title="安装、配置和部署私有化code-push-server"></a>安装、配置和部署私有化code-push-server</h3><p>这里的服务端使用源码<a target="_blank" rel="noopener" href="https://github.com/lisong/code-push-server.git">github.com&#x2F;lisong&#x2F;code…</a><br>克隆源码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">clone</span> https://github.com/lisong/code-push-server.git</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> code-push-server</span></span><br></pre></td></tr></table></figure>
<p>修改<strong>config.js</strong>配置文件里数据相关和其他配置<br><img src="https://chopstickqy.github.io/images/2021-06-15/1.png" alt="image"></p>
<p><img src="https://chopstickqy.github.io/images/2021-06-15/2.png" alt="image"><br>因为本地安装的mysql数据库版本比项目中客户端所支持的版本高，所以要升级<code>mysql2</code>依赖，修改<strong>package.json</strong>中<code>mysql2</code>版本为2.2.5。<br><img src="https://chopstickqy.github.io/images/2021-06-15/3.png" alt="image"></p>
<p>继续执行命令安装依赖包和运行服务：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">npm install</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./bin/db init --dbname codepush --dbhost localhost --dbuser root --dbpassword 123456 --dbport 3306 <span class="comment">#初始化mysql数据库</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./bin/www <span class="comment">#启动服务 浏览器中打开 http://127.0.0.1:3000 默认登录密码:admin/123456</span></span></span><br></pre></td></tr></table></figure>

<h3 id="安装-CodePush-Cli-客户端"><a href="#安装-CodePush-Cli-客户端" class="headerlink" title="安装 CodePush Cli 客户端"></a>安装 CodePush Cli 客户端</h3><p>在本地终端安装<code>CodePush CLI</code>客户端（因为后面需要自己打包上传项目，所以安装在自己开发的电脑上即可）。<br>这里由于<code>code-push-server</code>版本原因，我们来指定版本2.1.9来安装:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g code-push-cli@2.1.9</span><br></pre></td></tr></table></figure>
<p>使用客户端进行登录</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code-push login http://xxx.xxx.xxx.xxx:3000</span><br></pre></td></tr></table></figure>

<p>命令执行会打开浏览器跳转到服务器页面获取<code>token</code>，使用默认admin&#x2F;123456登录，复制取到的<code>token</code>保存即可。</p>
<h3 id="注册-APP"><a href="#注册-APP" class="headerlink" title="注册 APP"></a>注册 APP</h3><p>为了让<code>CodePush</code>服务知道你的项目，我们需要向它注册APP。<br>在终端输入<code>code-push add &lt;appname&gt; &lt;os&gt; &lt;platform&gt;</code>,并且<code>appname</code>要加<code>-android</code>或者<code>-ios</code>结尾，然后是平台，最后加上是<code>react-native</code>或者<code>cordova</code>，例如：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code-push app add codepush-ionic-test-android android cordova</span><br></pre></td></tr></table></figure>

<h2 id="在项目中集成CodePush-SDK"><a href="#在项目中集成CodePush-SDK" class="headerlink" title="在项目中集成CodePush SDK"></a>在项目中集成CodePush SDK</h2><p><em>参考文档：<a target="_blank" rel="noopener" href="https://ionicframework.com/docs/native/code-push">ionicframework.com&#x2F;docs&#x2F;native…</a></em></p>
<h3 id="安装-code-push-cordova插件"><a href="#安装-code-push-cordova插件" class="headerlink" title="安装 code-push cordova插件"></a>安装 code-push cordova插件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ionic cordova plugin add cordova-plugin-code-push</span><br><span class="line">npm install @ionic-native/code-push</span><br></pre></td></tr></table></figure>
<h3 id="code-push-cordova-插件配置"><a href="#code-push-cordova-插件配置" class="headerlink" title="code push cordova 插件配置"></a>code push cordova 插件配置</h3><p>在<strong>config.xml</strong>文件中设置生成的<code>deploymentkey</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">platform</span> <span class="attr">name</span>=<span class="string">&quot;android&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">preference</span> <span class="attr">name</span>=<span class="string">&quot;CodePushDeploymentKey&quot;</span> <span class="attr">value</span>=<span class="string">&quot;YOUR-ANDROID-DEPLOYMENT-KEY&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">preference</span> <span class="attr">name</span>=<span class="string">&quot;codepushserverurl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;http://xxxx.xxxx.xxxx.xxxx:3000&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">platform</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">platform</span> <span class="attr">name</span>=<span class="string">&quot;ios&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">preference</span> <span class="attr">name</span>=<span class="string">&quot;CodePushDeploymentKey&quot;</span> <span class="attr">value</span>=<span class="string">&quot;YOUR-IOS-DEPLOYMENT-KEY&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">preference</span> <span class="attr">name</span>=<span class="string">&quot;codepushserverurl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;http://xxxx.xxxx.xxxx.xxxx:3000&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">platform</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>###代码集成</p>
<p>修改 <code>src/app/app.module.ts</code> (将CodePush设置为 provider)。</p>
<p>最后，在<code>src/app.component.ts</code>中使用插件：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@angular/core&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Platform</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ionic-angular&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">StatusBar</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@ionic-native/status-bar&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">SplashScreen</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@ionic-native/splash-screen&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">HomePage</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../pages/home/home&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">CodePush</span>, <span class="title class_">InstallMode</span>, <span class="title class_">SyncStatus</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@ionic-native/code-push&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AlertController</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;ionic-angular/components/alert/alert-controller&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  <span class="attr">templateUrl</span>: <span class="string">&#x27;app.html&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">MyApp</span> &#123;</span><br><span class="line">  <span class="attr">rootPage</span>:<span class="built_in">any</span> = <span class="title class_">HomePage</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">platform</span>: <span class="title class_">Platform</span>, <span class="attr">statusBar</span>: <span class="title class_">StatusBar</span>, <span class="attr">splashScreen</span>: <span class="title class_">SplashScreen</span>,</span></span><br><span class="line"><span class="params">              <span class="keyword">private</span> <span class="attr">codePush</span>: <span class="title class_">CodePush</span>,  <span class="keyword">private</span> <span class="attr">alertCtrl</span>: <span class="title class_">AlertController</span></span>) &#123;</span><br><span class="line">    platform.<span class="title function_">ready</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// Okay, so the platform is ready and our plugins are available.</span></span><br><span class="line">      <span class="comment">// Here you can do any higher level native things you might need.</span></span><br><span class="line">      statusBar.<span class="title function_">styleDefault</span>();</span><br><span class="line">      splashScreen.<span class="title function_">hide</span>();</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">checkCodePush</span>(); <span class="comment">//Use the plugin always after platform.ready()</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">checkCodePush</span>(<span class="params"></span>) &#123;</span><br><span class="line">     <span class="variable language_">this</span>.<span class="property">codePush</span>.<span class="title function_">sync</span>(&#123;</span><br><span class="line">      <span class="attr">updateDialog</span>: &#123;</span><br><span class="line">       <span class="attr">appendReleaseDescription</span>: <span class="literal">true</span>,</span><br><span class="line">       <span class="attr">descriptionPrefix</span>: <span class="string">&quot;\n\nChange log:\n&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">installMode</span>: <span class="title class_">InstallMode</span>.<span class="property">IMMEDIATE</span></span><br><span class="line">   &#125;).<span class="title function_">subscribe</span>(</span><br><span class="line">     <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;CODE PUSH SUCCESSFUL: &#x27;</span> + data);</span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;CODE PUSH ERROR: &#x27;</span> + err);</span><br><span class="line">     &#125;</span><br><span class="line">   );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="发布更新、热部署"><a href="#发布更新、热部署" class="headerlink" title="发布更新、热部署"></a>发布更新、热部署</h2><p>IOS:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code-push release codepush-ionic-test-ios ./platforms/ios/www/ 0.0.1 --description &quot;Your awesome change description&quot; -d &quot;Staging&quot;</span><br></pre></td></tr></table></figure>

<p>Android:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code-push release codepush-ionic-test-android ./platforms/android/app/src/main/assets/www/ 0.0.1 --description &quot;Your awesome change description&quot; -d &quot;Staging&quot;</span><br></pre></td></tr></table></figure>

<p>**<em>注意：发布的版本要和线上的一致，否则无法更新</em><br>发布后重新启动APP即可看到更新的弹窗提示。</p>
<p>参考文献：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/7d44c244ac5c?utm_campaign=maleskine&utm_content=note&utm_medium=seo_notes&utm_source=recommendation">使用微软code push和私有化部署code-push-server的过程</a></li>
<li><a target="_blank" rel="noopener" href="http://www.bubuko.com/infodetail-2754143.html%C2%A0">服务器端code-push-server、mysql服务的架设</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://chopstickqy.github.io/post/2020-03-27.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Charles">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Charles's blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Charles's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/post/2020-03-27.html" class="post-title-link" itemprop="url">解决IE8连接TLS 1.0服务端的问题</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-27 00:00:00" itemprop="dateCreated datePublished" datetime="2020-03-27T00:00:00+08:00">2020-03-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-05-07 20:24:14" itemprop="dateModified" datetime="2025-05-07T20:24:14+08:00">2025-05-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">技术</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><p>在某些情况下，IE8客户端无法连接到支持TLS 1.0协议的服务端。这表明客户端请求的Cipher Suite在服务端不被支持。问题原因是服务端的JDK&#x2F;JRE默认不支持IE8所需的Cipher Suite。</p>
<h2 id="IE8支持的Cipher-Suite"><a href="#IE8支持的Cipher-Suite" class="headerlink" title="IE8支持的Cipher Suite"></a>IE8支持的Cipher Suite</h2><p>以下是IE8在TLS1.0协议下支持的Cipher Suite列表：</p>
<ul>
<li>Cipher Suite: TLS_RSA_WITH_AES_256_CBC_SHA (0x0035)</li>
<li>Cipher Suite: TLS_RSA_WITH_3DES_EDE_CBC_SHA (0x000a)</li>
<li>Cipher Suite: TLS_RSA_WITH_AES_128_CBC_SHA (0x002f)</li>
<li>Cipher Suite: TLS_RSA_WITH_RC4_128_SHA (0x0005)</li>
<li>Cipher Suite: TLS_RSA_WITH_RC4_128_MD5 (0x0004)</li>
<li>Cipher Suite: TLS_RSA_WITH_DES_CBC_SHA (0x0009)</li>
</ul>
<h2 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h2><p>当前装的JDK&#x2F;JRE版本并不包含这些Cipher Suite，因此导致IE8无法连接到服务端。</p>
<h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><h3 id="1-下载并安装Java-Cryptography-Extension-JCE-Unlimited-Strength-Jurisdiction-Policy-Files"><a href="#1-下载并安装Java-Cryptography-Extension-JCE-Unlimited-Strength-Jurisdiction-Policy-Files" class="headerlink" title="1. 下载并安装Java Cryptography Extension (JCE) Unlimited Strength Jurisdiction Policy Files"></a>1. 下载并安装Java Cryptography Extension (JCE) Unlimited Strength Jurisdiction Policy Files</h3><p>为了解决Cipher Suite不兼容的问题，我们需要下载并安装Java Cryptography Extension (JCE) Unlimited Strength Jurisdiction Policy Files。</p>
<ul>
<li>下载地址：<a target="_blank" rel="noopener" href="http://www.oracle.com/technetwork/java/javase/downloads/jce8-download-2133166.html">JCE Unlimited Strength Jurisdiction Policy Files 8</a></li>
<li>安装后，需要替换掉JRE的<code>lib/security</code>目录下的两个jar文件。</li>
</ul>
<h3 id="2-配置服务端支持更多Cipher-Suites"><a href="#2-配置服务端支持更多Cipher-Suites" class="headerlink" title="2. 配置服务端支持更多Cipher Suites"></a>2. 配置服务端支持更多Cipher Suites</h3><p>安装JCE后，我们需要在Spring Boot的配置文件中指定支持的Cipher Suites。以下是一个包含常见Cipher Suites的配置，可以将其加入到<code>application.yml</code>文件中：</p>
<pre><code class="yaml">server:
  ssl:
    ciphers: TLS_ECDH_anon_WITH_RC4_128_SHA, TLS_ECDH_ECDSA_WITH_RC4_128_SHA, 
            TLS_ECDH_RSA_WITH_RC4_128_SHA, TLS_ECDHE_ECDSA_WITH_RC4_128_SHA
            TLS_KRB5_EXPORT_WITH_RC4_40_MD5, TLS_KRB5_EXPORT_WITH_RC4_40_SHA
            TLS_KRB5_WITH_RC4_128_MD5, TLS_KRB5_WITH_RC4_128_SHA
            TLS_DH_anon_WITH_AES_128_GCM_SHA256, TLS_DH_anon_WITH_AES_256_GCM_SHA384
            TLS_DHE_DSS_WITH_AES_128_GCM_SHA256, TLS_DHE_DSS_WITH_AES_256_GCM_SHA384
            TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256, TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384
            TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256, TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384
            TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256, TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
            TLS_RSA_WITH_RC4_128_MD5, TLS_RSA_WITH_RC4_128_SHA
            TLS_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_RSA_WITH_AES_128_CBC_SHA
            TLS_ECDHE_RSA_WITH_RC4_128_SHA, TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA
            TLS_RSA_WITH
</code></pre>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>





</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Charles</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  <script src="/js/third-party/pace.js"></script>


  





</body>
</html>
